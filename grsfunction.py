#function to return the position of the Great Red Spot with respect to the Jovian apprent noon as observed from earth given a Julian Date (JD)
#James Stapleton, jamescstapleton@gmail.com


import sys
from math import sin, cos, tan, pi, atan, radians, degrees, sqrt, fsum


#set decimals to 28 places


from decimal import *
getcontext().prec = 28


def grs(JD):
	JDE = float(JD)


    
    #find right ascension, right declination, and non-adjusted longitude of system II
	date1 = JDE - 2433282.5
	time1 = date1/36525

	
	rAsc0 = 268.00 + 0.1061*time1
	rDec0 = 64.5 - 0.0164*time1
	Wsub2 = 16.838 + (870.27003539 * float(date1))


    
    # term calculator for position series for earth
	tau1 = (JDE - 2451545)/365250


    
    # data used for creating series for Earth's heliocentric longitude (from Appendix II of Astronimcal Algorithms or VSOP87)
	earthL0A = [175347046,

                3341656,

                34894,

                3497,

                3418,

                3136,

                2676,

                2343,

                1324,

                1273,

                1199,

                990,

                902,

                857,

                780,

                753,

                505,

                492,

                357,

                317,

                284,

                271,

                243,

                206,

                205,

                202,

                156,

                132,

                126,

                115,

                103,

                102,

                102,

                99,
 
                98,

                86,

                85,

                85,

                80,

                79,

                75,

                74,

                74,

                70,

                62,

                61,

                57,

                56,

                56,

                52,

                52,

                51,

                49,

                41,

                41,

                39,

                37,

                37,

                36,

                36,

                33,

                30,

                30,

                25]

	earthL0B = [0,

                4.6692568,

                4.62610,

                2.7441,

                2.8289,

                3.6277,

                4.4181,

                6.1352,

                0.7425,

                2.0371,

                1.1096,

                5.233,

                2.045,

                3.508,

                1.179,

                2.533,

                4.583,

                4.205,

                2.920,

                5.849,

                1.899,

                0.315,

                0.345,

                4.806,

                1.869,

                2.458,

                0.833,

                3.411,

                1.083,

                0.645,

                0.636,

                0.976,

                4.267,

                6.21,

                0.68,

                5.98,

                1.30,

                3.67,

                1.81,

                3.04,

                1.76,

                3.50,

                4.68,

                0.83,

                3.98,

                1.82,

                2.78,

                4.39,

                3.47,

                0.19,

                1.33,

                0.28,

                0.49,

                5.37,

                2.40,

                6.17,

                6.04,

                2.57,

                1.71,

                1.78,

                0.59,

                0.44,

                2.74,

                3.16]

	earthL0C = [0,

                6283.0758500,

                12566.15170,

                5753.3849,

                3.5231,

                77713.7715,

                7860.4194,

                3930.2097,

                11506.7698,

                529.6910,

                1577.3435,

                5884.927,

                26.298,

                398.149,

                5223.694,

                5507.663,

                18849.228,

                775.523,

                0.067,

                11790.629,

                796.298,

                10977.079,

                5486.778,

                2544.314,

                5573.143,

                6069.777,

                213.299,

                294.463,

                20.775,

                0.980,

                4694.003,

                15720.839,

                7.114,

                2146.17,

                155.42,

                161000.69,

                6275.96,

                71430.70,

                17260.15,

                12036.46,

                5088.63,

                3154.69,

                801.82,

                9437.76,

                8827.39,

                7084.90,

                6286.60,

                14143.50,

                6279.55,

                12139.55,

                1748.02,

                5856.48,

                1194.45,

                8429.24,
                19651.05,

                10447.39,

                10213.29,

                1059.38,

                2352.87,

                6812.77,

                17789.85,

                83996.85,

                1349.87,

                4690.48]

	earthL0D = []

	earthL0 = 0

	earthL1A = [628331966747,

                206059,

                4303,

                425,

                119,

                109,

                93,

                72,

                68,

                67,

                59,

                56,
		45,

                36,

                29,

                21,

                19,

                19,

                17,

                16,

                16,

                15,

		12,

                12,

                12,

                12,

                11,

                10,

                10,

                9,

                9,

                8,

                6,

		6]

	earthL1B = [0,

                2.678235,

                2.6351,

                1.590,

                5.796,

                2.666,

                2.59,

                1.14,

                1.87,

                4.41,

                2.89,

                2.17,

                0.40,

                0.47,

                2.65,

                5.34,

         	1.85,

                4.97,

                2.99,

                0.03,

                1.43,

                1.21,

                2.83,

                3.26,

                5.27,

                2.08,

                0.77,

                1.30,

                4.24,

                2.70,

                5.64,

                5.30,

                2.65,

                4.67]

    
   
	earthL1C = [0,

                6283.075850,

                12566.15170,

                3.523,

                26.298,
                1577.344,

                18849.23,

                529.69,

  		398.15,

                5507.55,

                5223.69,

                155.42,

                796.30,

                775.52,

                7.11,

                0.98,
                5486.78,

                213.30,

                6275.96,

                2544.31,

                2146.17,

                10977.08,

                1748.02,

                5088.63,

                1194.45,

                4694.00,

                553.57,

                6286.60,

                1349.87,

                242.73,

                951.72,

                2352.87,

                9437.76,

 		4690.48]

	earthL1D = []


	earthL1 = 0

    
    
	earthL2A = [52919,

                8720,

                309,

                27,

                16,

                16,
                10,

                9,

                7,

                5,

 		4,

                4,

                3,

                3,

                3,

                3,

                3,

                3,

                2,

                2]


    
    	
	earthL2B = [0,

                1.0731,

                0.867,

                0.05,

                5.19,

                3.68,

                0.76,

                2.06,

                0.83,

     		4.66,

                1.03,

                3.44,

                5.14,

                6.05,

                1.19,

                6.12,

                0.31,

                2.28,

                4.38,

                3.75]

	earthL2C = [0,

                6283.0758,

                12566.152,

                3.52,

                26.30,

                155.42,

                18849.23,

                77713.77,

        	775.52,

                1577.34,

                7.11,

                5573.14,

                796.30,

                5507.55,

                242.73,

                529.69,

                398.15,

                553.57,

                5223.69,

                0.98]

	earthL2D = []

	earthL2 = 0

	earthL3A = [289,

                35,

                17,

                3,

                1,

                1,

                1]


	earthL3B = [5.844,

                0,

                5.49,

                5.20,

                4.72,

                5.30,

                5.97]


	earthL3C = [6283.076,

                0,

                12566.15,

                155.42,

                3.52,

                18849.23,

                242.73]

	earthL3D = []


	earthL3 = 0


	earthL4A = [114,

                8,

                1]


	earthL4B = [3.142,

                4.13,

                3.84]

	earthL4C = [0,

                6283.08,

                12566.15]

	earthL4D = []

	earthL4 = 0


	earthL5A = [1]

	earthL5B = [3.14]

	earthL5C = [0]


	earthL5D = []

	earthL5 = 0


    
    
#data for creating series for heliocentric latitude, from AII of AA and VSOP87:


	earthB0A = [280,

                102,

                80,

                44,

                32]

	earthB0B = [3.199,

                5.422,

                3.88,

                3.70,

                4.00]

	earthB0C = [84334.662,

                5507.553,

                5223.69,

                2352.87,

                1577.34]

	earthB0D = []

	earthB0 = 0

	earthB1A = [9,

                6]

	earthB1B = [3.90,

                1.73]

	earthB1C = [5507.55,

                5223.69]

	earthB1D = []

	earthB1 = 0


    
    
#data for Earth's radius vector:

	earthR0A = [100013989,

                1670700,

                13956,

                3084,

                1628,

                1576,

                925,

                542,

                472,

                346,

                329,

                307,

                243,

                212,

                186,

                175,

                110,

                98,

                86,

                86,

                65,

                63,

                57,

                56,

                49,

                47,

                45,

                43,

                39,

    		38,

                37,

                37,

                36,

                35,

                33,

                32,

                32,

                28,

                28,

                26]


	earthR0B = [0,

                3.0984635,

                3.05525,

                5.1985,

                1.1739,

                2.8469,

                5.453,

                4.564,

             	3.661,

                0.964,

                5.900,

                0.299,

                4.273,

                5.847,

                5.022,

                3.012,

                5.055,

             	0.89,

                5.69,

                1.27,

                0.27,

                0.92,

                2.01,

                5.24,

                3.25,

                2.58,

                5.54,

                6.01,

                5.36,

                2.39,

                0.83,

                4.90,

                1.67,

                1.84,

                0.24,

                0.18,

                1.78,

                1.21,

                1.90,

                4.59]


	earthR0C = [0,

                6283.0758500,

                12566.15170,

                7713.771,

                5753.384,

                7860.4194,

                11506.770,

                3930.210,

                5884.927,

                5507.553,

                5223.694,

                5573.143,

                11790.629,

                1577.344,

                10977.079,

            	18849.228,

                5486.778,

                6069.78,

                15720.84,

                161000.69,

                17260.15,

                529.69,

                83996.85,
        	71430.70,

                2544.31,

                775.52,

                9437.76,

                6275.96,

                4694.00,

                8827.39,

                19651.05,

                12139.55,

                12036.46,

                2942.46,

                7084.90,

                5088.63,

                398.15,

                6286.60,

                6279.55,

                10447.39]

	earthR0D = []

	earthR0 = 0

	earthR1A = [103019,

                1721,

                702,

                32,

                31,
                25,

                18,

                10,

                9,

                9]


	earthR1B = [1.107490,

                1.0644,

                3.142,

                1.02,

                2.84,

                1.32,

                1.42,

                5.91,

                1.42,

                0.27]


	earthR1C = [6283.075850,

                12566.1517,

                0,

                18849.23,

                5507.55,

                5223.69,

                1577.34,

                10977.08,

                6275.96,

                5486.78]

	earthR1D = []

	earthR1 = 0

	earthR2A = [4359,

                124,

                12,

                9,

                6,

                3]

	earthR2B = [5.7846,

                5.579,

                3.14,

                3.63,

                1.87,

                5.47]

    
   
	earthR2C = [6283.0758,

                12566.1517,

                0,

                77713.77,

                5573.14,

                18849.23]


	earthR2D = []

	earthR2 = 0


	earthR3A = [145,

                7]

	earthR3B = [4.273,

                3.92]

	earthR3C = [6283.076,

                12566.1517]

	earthR3D = []

	earthR3 = 0

	earthR4A = [4]

    
    
	earthR4B = [2.56]

	earthR4C = [6283.08]

	earthR4D = []


	earthR4 = 0


    
    #function for populating "D" lists with terms in each series using the formula from Astronomical Algorithms, Term = Acos(B + C*tau1)
	def term(A, B, C, D):

        	for items in A:

            		D.append(items*cos(B[A.index(items)] + C[A.index(items)]*(tau1)))

    
    #populate D lists for earth's heliocentric longitude:

	term(earthL0A, earthL0B, earthL0C, earthL0D)
	term(earthL1A, earthL1B, earthL1C, earthL1D)
	term(earthL2A, earthL2B, earthL2C, earthL2D)
	term(earthL3A, earthL3B, earthL3C, earthL3D)

	term(earthL4A, earthL4B, earthL4C, earthL4D)
	term(earthL5A, earthL5B, earthL5C, earthL5D)

    
    
	#sum the series, store in coefficient variables in the form, planet(L/B/R)(Number of Coefficient)

	earthL0 = fsum(earthL0D)
	earthL1 = fsum(earthL1D)
	earthL2 = fsum(earthL2D)
	earthL3 = fsum(earthL3D)
	earthL4 = fsum(earthL4D)
	earthL5 = fsum(earthL5D)


    
    #store terms in D lists
	term(earthB0A, earthB0B, earthB0C, earthB0D)

	term(earthB1A, earthB1B, earthB1C, earthB1D)


    
    #sum of each series, store in number variables:
	earthB0 = fsum(earthB0D)
	earthB1 = fsum(earthB1D)


    
    #store terms in D lists
	term(earthR0A, earthR0B, earthR0C, earthR0D)
	term(earthR1A, earthR1B, earthR1C, earthR1D)
	term(earthR2A, earthR2B, earthR2C, earthR2D)
	term(earthR3A, earthR3B, earthR3C, earthR3D)
	term(earthR4A, earthR4B, earthR4C, earthR4D)


    
    #sum of each series, store in base variables
	earthR0 = fsum(earthR0D)

	earthR1 = fsum(earthR1D)
	earthR2 = fsum(earthR2D)
	earthR3 = fsum(earthR3D)
	earthR4 = fsum(earthR4D)

    
    
    # earth's heliocentric longitude:

	hl0 = (earthL0 + earthL1*tau1 + earthL2*(tau1**2) + earthL3*(tau1**3) + earthL4*(tau1**4) + earthL5*(tau1**5))/(100000000) % (2*pi)


    
    #earth's heliocentric latitude:

	hb0 = (earthB0 + earthB1*tau1)/(100000000) % (2*pi)


    
    #earth's radius vector:

	hr0 = (earthR0 + earthR1*(tau1) + earthR2*(tau1**2) + earthR3*(tau1**3) + earthR4*(tau1**4))/(100000000)


    
    # term calculator for position series for Jupiter
	tau1 = (JDE - 2451545)/365250


    
    # data used for creating series for Jupiter's heliocentric longitude (from Appendix II of Astronimcal Algorithms or VSOP87)

	jupiterL0A = [59954691,

                  9695899,

                  573610,

                  306389,

                  97178,

                  72903,

                  64264,

                  39806,

                  38858,

                  27965,

                  13590,

                  8769,

                  8246,

                  7368,

                  6263,

                  6114,

                  5305,

                  5305,

                  4905,

                  4647,

                  3045,

                  2610,

                  2028,

                  1921,

                  1765,

                  1723,

                  1633,

                  1432,

                  973,

                  884,

                  733,

                  731,

                  709,

                  692,

                  614,

                  582,

                  495,

                  441,

                  417,

                  390,

                  376,

                  341,

                  330,

                  262,

                  261,

                  257,

                  244,

                  235,

                  220,

                  207,

                  202,

                  197,

                  175,

                  175,

                  175,

                  158,

                  151,

                  149,

                  141,

                  138,

                  131,

                  117,

                  117,

                  106]

	jupiterL0B = [0,

                  5.0619179,

                  1.444062,

                  5.417347,

                  4.14265,

                  3.64043,

                  3.41145,

                  2.29377,

                  1.27232,

                  1.78455,

                  5.77481,

                  3.6300,

                  3.5823,

                  5.0810,

                  0.0250,

                  4.5132,

                  4.1863,

                  1.3067,

                  1.3208,

                  4.6996,

                  4.3168,

                  1.5667,

                  1.0638,

                  0.9717,

                  2.1415,

                  3.8804,

                  3.5820,

                  4.2968,

                  4.098,

                  2.437,

                  6.085,

                  3.806,

                  1.293,

                  6.134,

                  4.109,

                  4.540,

                  3.756,

                  2.958,

                  1.036,

                  4.897,

                  4.703,

                  5.715,

                  4.740,

                  1.877,

                  0.820,

                  3.724,

                  5.220,

                  1.227,

                  1.651,

                  1.855,

                  1.807,

                  5.293,

                  3.730,

                  3.226,

                  5.910,

                  4.365,

                  3.906,

                  4.377,

                  3.136,

                  1.318,

                  4.169,

                  2.500,

                  3.389,

                  4.554]


	jupiterL0C = [0,

                  529.6909651,

                  7.113547,

                  1059.381930,

                  632.78374,

                  522.57742,

                  103.09277,

                  419.48464,

                  316.39187,

                  536.80451,

                  1589.07290,

                  949.1756,

                  206.1855,

                  735.8765,

                  213.2991,

                  1162.4747,

                  1052.2684,

                  14.2271,

                  110.2063,

                  3.9322,

                  426.5982,

                  846.0828,

                  3.1814,

                  639.8973,

                  1066.4955,

                  1265.567,

                  515.4639,

                  625.6702,

                  95.979,

                  412.371,

                  838.969,

                  1581.959,

                  742.990,

                  2118.764,

                  1478.867,

                  309.278,

                  323.505,

                  454.909,

                  2.448,

                  1692.166,

                  1368.660,

                  533.623,

                  0.048,

                  0.963,

                  380.128,

                  199.072,

                  728.763,

                  909.819,

                  543.918,

                  525.759,

                  1375.774,

                  1155.361,

                  942.062,

                  1898.351,

                  956.289,

                  1795.258,

                  74.782,

                  1685.052,

                  491.558,

                  1169.588,

                  1045.155,

                  1596.186,

                  0.521,

                  526.510]

	jupiterL0D = []


	jupiterL1A = [52993480757,

                  489741,

                  228919,

                  27655,

                  20721,

                  12106,

                  6068,

                  5434,

                  4238,

                  2212,

                  1746,

                  1296,

                  1173,

                  1163,

                  1099,

                  1007,

                  1004,

                  848,

                  827,

                  816,

                  725,

                  568,

                  474,

                  413,

                  345,

                  336,

                  234,

                  199,

                  195,

                  187,

                  184,

                  171,

                  131,

                  115,

                  115,

                  108,

                  80,

                  72,

                  70,

                  67,

                  66,

                  65,

                  59,

                  58,

                  57,

                  57,

                  55,

                  52,

                  52,

                  50,

                  47,

                  47,

                  40,

                  34,

                  33,

                  32,

                  29,

                  29,

                  29,

                  25]


	jupiterL1B = [0,

                  4.220667,

                  6.026475,

                  4.57266,

                  5.45939,

                  0.16986,

                  4.4242,

                  3.9848,

                  5.8901,

                  5.2677,

                  4.9267,

                  5.5513,

                  5.8565,

                  0.5145,

                  5.3070,

                  0.4648,

                  3.1504,

                  5.758,

                  4.803,

                  0.586,

                  5.518,

                  5.989,

                  4.132,

                  5.737,

                  4.242,

                  3.732,

                  4.035,

                  6.243,

                  1.505,

                  2.219,

                  6.086,

                  6.280,

                  5.417,

                  0.626,

                  0.680,

                  5.286,

                  4.493,

                  5.82,

                  5.34,

                  5.97,

                  5.73,

                  0.13,

                  6.09,

                  0.59,

                  0.99,

                  5.97,

                  1.41,

                  5.43,

                  5.73,

                  0.23,

                  6.08,

                  3.63,

                  0.51,

                  4.16,

                  0.10,

                  5.04,

                  5.37,

                  5.42,

                  3.36,

                  0.76,

                  1.61]


	jupiterL1C = [0,

                  529.690965,

                  7.113547,

                  1059.38193,

                  522.57742,

                  536.80451,

                  103.0928,

                  419.4846,

                  14.2271,

                  206.1855,

                  1589.0729,

                  3.1814,

                  1052.2684,

                  3.9322,

                  515.4639,

                  735.8765,

                  426.5982,

                  110.206,

                  213.299,

                  1066.495,

                  639.897,

                  625.670,

                  412.371,

                  95.979,

                  632.784,

                  1162.475,

                  949.176,

                  309.278,

                  838.969,

                  323.505,

                  742.990,

                  543.918,

                  199.072,

                  728.763,

                  846.083,

                  2118.764,

                  956.289,

                  1045.15,

                  942.06,

                  532.87,

                  21.34,

                  526.51,

                  1581.96,

                  1155.36,

                  1596.19,

                  1169.59,

                  533.62,

                  10.29,

                  117.32,

                  1368.66,

                  525.76,

                  1478.87,

                  1265.57,

                  1692.17,

                  302.16,

                  220.41,

                  508.35,

                  1272.68,

                  4.67,

                  88.87,

                  831.86]

	jupiterL1D = []

	jupiterL2A = [47234,

                  38966,

                  30629,

                  3189,

                  2729,

                  2723,

                  1721,

                  383,

                  378,

                  367,

                  337,

                  308,

                  218,

                  199,

                  197,

                  156,

                  146,

                  142,

                  130,

                  117,

                  97,

                  91,

                  87,

                  79,

                  72,

                  58,

                  57,

                  49,

                  40,

                  40,

                  36,

                  29,

                  28,

                  26,

                  26,

                  25,

                  24,

                  19,

                  18,

                  17,

                  17,

                  15,

                  15,

                  15,

                  14,

                  14,

                  13,

                  13,

                  11,

                  10,

                  9,

                  9,

                  9,

                  8,

                  8,

                  7,

                  6]


	jupiterL2B = [4.32148,

                  0,

                  2.93021,

                  1.0550,

                  4.8455,

                  3.4141,

                  4.1873,

                  5.768,

                  0.760,

                  6.055,

                  3.786,

                  0.694,

                  3.814,

                  5.340,

                  2.484,

                  1.406,

                  3.814,

                  1.634,

                  5.837,

                  1.414,

                  4.03,

                  1.11,

                  2.52,

                  4.64,

                  2.22,

                  0.83,

                  3.12,

                  1.67,

                  4.02,

                  0.62,

                  2.33,

                  3.61,

                  3.24,

                  4.50,

                  2.51,

                  1.22,

                  3.01,

                  4.29,

                  0.81,

                  4.20,

                  1.83,

                  5.81,

                  0.68,

                  4.00,

                  5.95,

                  1.80,

                  2.52,

                  4.37,

                  4.44,

                  1.72,

                  2.18,

                  3.29,

                  3.32,

                  5.76,

                  2.71,

                  2.18,

                  0.50]

	jupiterL2C = [7.321355,

                  0,

                  529.69097,

                  522.5774,

                  536.8045,

                  1509.381,

                  14.2271,

                  419.485,

                  515.464,

                  103.093,

                  3.181,

                  206.186,

                  1589.073,

                  1066.495,

                  3.932,

                  1052.268,

                  639.897,

                  426.598,

                  412.371,

                  625.670,

                  110.21,

                  95.98,

                  632.78,

                  543.92,

                  735.88,

                  199.07,

                  213.30,

                  309.28,

                  21.34,

                  323.51,

                  728.76,

                  10.29,

                  838.97,

                  742.99,

                  1162.47,

                  1045.15,

                  956.29,

                  532.87,

                  508.35,

                  2118.76,

                  526.51,

                  1596.19,

                  942.06,

                  117.32,

                  316.39,

                  302.16,

                  88.87,

                  1169.59,

                  525.76,

                  1581.96,

                  1155.36,

                  220.41,

                  831.86,

                  856.08,

                  533.62,

                  1265.57,

                  949.18]


	jupiterL2D = []

	jupiterL3A = [6502,

                  1357,

                  471,

                  417,

                  353,

                  155,

                  87,

                  44,

                  34,

                  28,

                  24,

                  23,

                  20,

                  20,

                  19,

                  17,

                  17,

                  16,

                  16,

                  13,

                  13,

                  13,

                  9,

                  9,

                  7,

                  7,

                  6,

                  5,

                  5,

                  4,

                  4,

                  4,

                  3,

                  3,

                  3,

                  3,

                  3,

                  2,

                  2]

	jupiterL3B = [2.598,

                  1.346,

                  2.475,

                  3.245,

                  2.974,

                  2.076,

                  2.51,

                  0,

                  3.83,

                  2.45,

                  1.28,

                  2.98,

                  2.10,

                  1.40,

                  1.59,

                  2.30,

                  2.60,

                  3.15,

                  3.36,

                  2.76,

                  2.54,

                  6.27,

                  1.76,

                  2.27,

                  3.43,

                  4.04,

                  2.52,

                  2.91,

                  5.25,

                  4.30,

                  3.52,

                  4.09,

                  1.43,

                  4.36,

                  1.25,

                  5.02,

                  2.24,

                  2.90,

                  2.36]

	jupiterL3C = [7.1135,

                  529.6910,

                  14.227,

                  536.805,

                  522.577,

                  1059.382,

                  515.46,

                  0,

                  1066.50,

                  206.19,

                  412.37,

                  543.92,

                  639.90,

                  419.48,

                  103.09,

                  21.34,

                  1589.07,

                  625.67,

                  1052.27,

                  95.98,

                  199.07,

                  426.60,

                  10.29,

                  110.21,

                  309.28,

                  728.76,

                  508.35,

                  1045.15,

                  323.51,

                  88.87,

                  302.16,

                  735.88,

                  956.29,

                  1596.19,

                  213.30,

                  838.97,

                  117.32,

                  742.99,

                  942.06]

	jupiterL3D = []

	jupiterL4A = [669,

                  114,

                  100,

                  50,

                  44,

                  32,

                  15,

                  9,

                  5,

                  4,

                  4,

                  3,

                  2,
                  2,

                  2,

                  2,

                  1,

                  1,

                  1]

	jupiterL4B = [0.853,

                  3.142,

                  0.743,

                  1.65,

                  5.82,

                  4.86,

                  4.29,

                  0.71,

                  1.30,

                  2.32,

                  0.48,

                  3.00,

                  0.40,

                  4.26,

                  4.91,

                  4.26,

                  5.26,

                  4.72,

                  1.29]

	jupiterL4C = [7.114,

                  0,

                  14.227,

                  536.80,

                  529.69,

                  522.58,

                  515.46,

                  1059.38,

                  543.92,

                  1066.50,

                  21.34,

                  412.37,

                  639.90,

                  199.07,

                  625.67,

                  206.19,

                  1052.27,

                  95.98,

                  1589.07]

	jupiterL4D = []

	jupiterL5A = [50,

                  16,

                  4,

                  2,
                  1]

	jupiterL5B = [5.26,

                  5.25,

                  0.01,
                  1.10,

                  3.14]

	jupiterL5C = [7.11,

                  14.23,

                  536.80,

                  522.58,

                  0]

	jupiterL5D = []

	jupiterB0A = [2268616,

                  110090,

                  109972,

                  8101,

                  6438,

                  6044,

                  1107,

                  944,

                  942,

                  894,

                  836,

                  767,

                  684,

                  629,

                  559,

                  532,

                  464,

                  431,

                  351,

                  132,

                  123,

                  116,

                  115,

                  104,

                  103,

                  102]

	jupiterB0B = [3.5585261,

                  0,

                  3.908093,

                  3.6051,

                  0.3063,

                  4.2588,

                  2.9853,

                  1.675,

                  2.936,

                  1.754,

                  5.179,

                  2.155,

                  3.678,

                  0.643,

                  0.014,

                  2.703,

                  1.173,

                  2.608,

                  4.611,

                  4.778,

                  3.350,

                  1.387,

                  5.049,

                  3.701,

                  2.319,

                  3.153]

	jupiterB0C = [529.6909651,

                  0,

                  1059.381930,

                  522.5774,

                  536.8045,

                  1589.0729,

                  1162.4747,

                  426.598,

                  1052.268,

                  7.114,

                  103.093,

                  632.784,

                  213.299,

                  1066.495,

                  846.083,

                  110.206,

                  949.176,

                  419.485,

                  2118.764,

                  742.990,

                  1692.166,

                  323.505,

                  316.392,

                  515.464,

                  1478.867,

                  1581.959]

	jupiterB0D = []


	jupiterB1A = [177352,

                  3230,

                  3081,

                  2212,

                  1694,

                  346,

                  234,

                  196,

                  150,

                  114,

                  97,

                  82,

                  77,

                  77,

                  74,

                  61,

                  50,

                  46,

                  45,

                  37,

                  36,

                  32]

	jupiterB1B = [5.701665,

                  5.7794,

                  5.4746,

                  4.7348,

                  3.1416,

                  4.746,

                  5.189,

                  6.186,

                  3.927,

                  3.439,

                  2.91,
                  5.08,

                  2.51,

                  0.61,

                  5.50,

                  5.45,

                  3.95,

                  0.54,

              	  1.90,

                  4.70,

                  6.11,

                  4.92]

	jupiterB1C = [529.690965,

                  1059.3819,

                  522.5774,

                  539.8045,

                  0,

                  1052.268,

                  1066.495,

                  7.114,

                  1589.073,

                  632.784,

                  949.18,

                  1162.47,

                  103.09,

                  419.48,

                  515.46,

                  213.30,

                  735.88,

                  110.21,

                  846.08,

                  543.92,

                  316.39,

                  1581.96]

	jupiterB1D = []

	jupiterB2A = [8094,

                  813,

                  742,

                  399,

                  342,

                  74,

                  46,

                  30,

                  29,

                  23,

                  14,

                  12,

                  11,

                  6]

	jupiterB2B = [1.4632,

                  3.1416,

                  0.957,

                  2.899,

                  1.447,

                  0.41,

                  3.48,

                  1.93,

           	  0.99,

                  4.27,

                  2.92,

                  5.22,

                  4.88,

                  6.21]

	jupiterB2C = [529.6910,

                  0,

		  522.577,

                  536.805,

                  1059.382,

                  1052.27,

                  1066.50,

                  1589.07,

                  515.46,

                  7.11,

                  543.92,

                  632.78,

                  949.18,

                  1045.15]

	jupiterB2D = []

	jupiterB3A = [252,

                  122,

                  49,

                  11,

                  8,

                  7,

                  6,

                  4,

                  3]

	jupiterB3B = [3.381,

                  2.733,

                  1.04,

                  2.31,

                  2.77,

                  4.25,

                  1.78,

                  1.13,

                  3.14]

	jupiterB3C = [529.691,

                  522.577,

                  536.80,

                  1052.27,

                  515.46,

                  1059.38,

                  1066.50,

                  543.92,

                  0]

	jupiterB3D = []

	jupiterB4A = [15,

                  5,

                  4,

                  3,

                  2,

                  1]

	jupiterB4B = [4.53,

                  4.47,

                  5.44,

                  0,

                  4.52,

                  4.20]

	jupiterB4C = [522.58,

                  529.69,

                  536.80,

                  0,

                  515.46,

                  1052.27]

	jupiterB4D = []

	jupiterB5A = [1]

	jupiterB5B = [0.09]


	jupiterB5C = [522.58]

	jupiterB5D = []

	jupiterR0A = [520887429,

                  25209327,

                  610600,

                  282029,

                  187647,

                  86793,

                  72063,

                  65517,

                  30135,

                  29135,

                  23947,

                  23453,

                  22284,

                  13033,

                  12749,

                  9703,

                  9161,

                  7895,
                  7058,

                  6138,

                  5477,

                  4170,

                  4137,

                  3503,

                  2617,

                  2500,
		  2128,

                  1912,

                  1611,

                  1479,

                  1231,

                  1217,

                  1015,

                  999,

                  961,
		  886,

                  821,

                  812,

                  777,

                  727,

                  655,

                  654,

                  621,

                  615,
        	  562,

                  542]

	jupiterR0B = [0,

                  3.49108640,

                  3.841154,

                  2.574199,

                  2.075904,

                  0.71001,

              	  0.21466,

                  5.97996,

                  2.16132,

                  1.67759,

                  0.27458,

                  3.54023,

                  4.19363,
		  2.96043,

                  2.71550,

                  1.9067,

                  4.4135,

                  2.4791,

                  2.1818,

                  6.2642,

                  5.6573,

              	  2.0161,

                  2.7222,

                  0.5653,

                  2.0099,

                  4.5518,

                  6.1275,

                  0.8562,

                  3.0887,

            	  2.6803,

                  1.8904,

                  1.8017,

                  1.3867,

                  2.872,

                  4.549,

                  4.148,

                  1.593,

              	  5.941,

                  3.677,

                  3.988,

                  2.791,

                  3.382,

                  4.823,

                  2.276,

                  0.081,

                  0.284]

	jupiterR0C = [0,

                  529.69096509,

                  1059.381930,

                  632.783739,

                  522.577418,

                  419.48464,

                  536.80451,

                  316.39187,

                  949.17561,

                  103.09277,

                  7.11355,

                  735.87651,

                  1589.07290,

                  1162.47470,

                  1052.26838,

                  206.1855,

                  213.2991,

                  426.5982,

                  1265.5675,

                  846.0828,

                  639.8973,

                  515.4639,

                  625.6702,

                  1066.4955,

                  1581.9593,

                  838.9693,

                  742.9901,

                  412.3711,

                  1368.6603,

                  1478.8666,

                  323.5054,

                  110.2063,

                  454.9094,

                  309.278,

                  2118.764,

                  533.623,

                  1898.351,

                  909.819,

                  728.763,

                  1155.361,

                  1685.052,

                  1692.166,

   		  956.289,

                  942.062,

                  543.918,

                  525.759]

	jupiterR0D = []

	jupiterR1A = [1271802,

                  61662,

                  53444,

                  41390,

                  31185,

                  11847,

                  9166,

                  3404,

                  3203,

                  3176,

                  2806,

   		  2677,

                  2600,

                  2412,

                  2101,

                  1646,

                  1641,

                  1050,

                  1025,

                  806,

                  741,

                  677,

                  567,

                  485,

                  469,

                  445,

                  416,

                  402,

                  347,

                  338,

                  261,

                  247,

                  220,

                  203,

                  200,

                  197,

                  196,

                  184,

                  180,

                  170,

                  146,

                  133,

                  132]

	jupiterR1B = [2.6493751,

                  3.00076,

                  3.89718,

                  0,

                  4.88277,

                  2.41330,

                  4.7598,

                  3.3469,

                  5.2108,

                  2.7930,

                  3.7422,

                  4.3305,

                  3.6344,

                  1.4695,

                  3.9276,

                  5.3095,

                  4.4163,

                  3.1611,

                  2.5543,
                  2.678,

                  2.171,

                  6.250,

                  4.577,

                  2.469,

                  4.710,

                  0.403,

                  5.368,

                  4.605,

                  4.681,

                  3.168,

                  5.343,

                  3.923,

                  4.842,

                  5.600,

                  4.439,

                  3.706,

                  3.759,

                  4.265,

                  4.402,

                  4.846,

                  6.130,

                  1.322,

                  4.512]

	jupiterR1C = [529.6909651,

                  1059.38193,

                  522.57742,

                  0,

                  536.80451,

                  419.48464,

                  7.1135,

                  1589.0729,

                  735.8765,

                  103.0928,

                  515.4639,

                  1052.2684,

                  206.1855,

                  426.5982,

                  639.8973,

                  1066.4955,

                  625.6702,

                  213.2991,

                  412.3711,

                  632.784,

                  1162.475,

                  838.969,

                  742.990,

                  949.176,

                  543.918,

                  323.505,

                  728.763,

                  309.278,

       		  14.227,

                  956.289,

                  846.083,

                  942.062,

                  1368.660,

                  1155.361,

                  1045.155,

                  2118.764,
                  199.072,

                  95.979,

                  532.872,

                  526.510,

                  533.623,

                  110.206,

                  525.759]

	jupiterR1D = []

	jupiterR2A = [79645,

                  8252,

                  7030,

                  5314,

                  1861,

                  964,

                  836,

               	  498,

                  427,

                  406,

                  377,

                  363,

                  342,

                  339,

                  333,

                  280,

               	  257,

                  230,

                  201,

                  200,

                  139,

                  114,

                  95,

                  86,

                  83,

                  80,

                  75,

                  70,

                  67,

                  62,

                  56,

                  52,

                  50,

                  45,

                  44,

      		  40]

	jupiterR2B = [1.35866,

                  5.7777,

                  3.2748,

                  1.8384,

                  2.9768,

                  5.480,

                  4.199,

     		  3.142,

                  2.228,

                  3.783,

                  2.242,

                  5.368,

                  6.099,

                  6.127,

                  0.003,

           	  4.262,

                  0.963,

                  0.705,

                  3.069,

                  4.429,

                  2.932,

                  0.787,

                  1.70,

                  5.14,

                  0.06,

                  2.98,

                  1.60,

                  1.51,

                  5.47,

                  6.10,

                  0.96,

                  5.58,
                  2.72,

                  5.52,

                  0.27,

                  5.95]

	jupiterR2C = [529.69097,

                  522.5774,

                  536.8045,

                  1059.3819,

 		  7.1135,

                  515.464,

                  419.485,

                  0,

                  639.897,

                  1066.495,

                  1589.073,

                  206.186,

                  1052.268,

                  625.670,

                  426.598,

                  412.371,

                  632.784,

                  735.877,

                  543.918,

       		  103.093,

                  14.227,

                  728.763,

                  838.97,

                  323.51,

                  309.28,

                  742.99,

                  956.29,

   		  213.30,

                  199.07,

                  1045.15,

                  1162.47,

                  942.06,

                  532.87,

                  508.35,

                  526.51,

                  95.98]

	jupiterR2D = []



	jupiterR3A = [3519,

                  1073,

                  916,

                  342,

                  255,

                  222,

  		  90,

                  69,

                  58,

                  58,

                  51,

                  47,

                  43,

                  37,

                  34,

           	  34,

                  31,

                  30,

                  21,

                  15,

                  14,

                  13,

                  12,

                  12,

                  11,

                  10,

                  9]

	jupiterR3B = [6.0580,

                  1.6732,

                  1.413,
                  0.523,

                  1.196,

                  0.952,

    		  3.14,

                  2.27,

                  1.41,

                  0.53,

                  5.98,

                  1.58,

                  6.12,
                  1.18,

                  1.67,

                  0.85,

                  1.04,

                  4.63,

                  2.50,

                  0.89,

                  0.96,

                  1.50,

                  2.61,

        	  3.56,

                  1.79,

                  6.28,

                  6.26,

                  3.45]

	jupiterR3C = [529.6910,

                  536.8045,

                  522.577,

        	  1059.382,

                  7.114,

                  515.464,

                  0,

                  1066.50,

                  543.92,

                  639.90,

                  412.37,

        	  625.67,

                  419.48,

                  14.23,

                  1052.27,

                  206.19,

                  1589.07,

                  426.60,

                  728.76,

     		  199.07,

                  508.35,

                  1045.15,

                  735.88,

                  323.51,

                  309.28,

                  956.29,

                  103.09,

                  838.97]

	jupiterR3D = []

	jupiterR4A = [129,

                  113,

                  83,

                  38,

                  27,

                  18,

                  13,

                  9,

                  8,

                  7,

                  6,

                  5,

                  3,

                  3,

                  3]

	jupiterR4B = [0.084,

     		  4.249,

                  3.30,

                  2.73,

                  5.69,

                  5.40,

                  6.02,

                  0.77,

                  5.68,

                  1.43,

                  5.12,

                  3.34,

                  3.40,

                  4.16,

                  2.90]

	jupiterR4C = [536.805,

                  529.691,

                  522.58,

                  515.46,

                  7.11,

                  1059.38,

                  543.92,

                  1066.50,

                  14.23,

                  412.37,

                  639.90,

                  625.67,

                  1052.27,

                  728.76,

                  426.60]

	jupiterR4D = []

	jupiterR5A = [11,

                  4,

                  2,

                  2,

                  2,

                  2,

                  2]

	jupiterR5B = [4.75,

                  5.92,

                  5.57,

                  4.30,

                  3.69,

                  4.13,

                  5.49]

	jupiterR5C = [536.80,

                  522.58,

                  515.46,

                  543.92,

                  7.11,

                  1059.38,

                  1066.50]

	jupiterR5D = []


    
    
    #function for populating "D" lists with terms in each series using the formula from Astronomical Algorithms, Term = Acos(B + C*tau1)
	def term(A, B, C, D):
		for items in A:
			D.append(items*cos(B[A.index(items)] + C[A.index(items)]*tau1))


    
    #populate D lists with other lists using term = A*cos(B + C*tau)

	term(jupiterL0A, jupiterL0B, jupiterL0C, jupiterL0D)
	term(jupiterL1A, jupiterL1B, jupiterL1C, jupiterL1D)
	term(jupiterL2A, jupiterL2B, jupiterL2C, jupiterL2D)
	term(jupiterL3A, jupiterL3B, jupiterL3C, jupiterL3D)
	term(jupiterL4A, jupiterL4B, jupiterL4C, jupiterL4D)
	term(jupiterL5A, jupiterL5B, jupiterL5C, jupiterL5D)


    
    #sum the series, store in coefficient variables in the form, planet(L/B/R)(Number of Coefficient)


	jupiterL0 = fsum(jupiterL0D)
	jupiterL1 = fsum(jupiterL1D)
	jupiterL2 = fsum(jupiterL2D)
	jupiterL3 = fsum(jupiterL3D)
	jupiterL4 = fsum(jupiterL4D)
	jupiterL5 = fsum(jupiterL5D)


    
    
    #store terms in D lists for latitude:
	term(jupiterB0A, jupiterB0B, jupiterB0C, jupiterB0D)
	term(jupiterB1A, jupiterB1B, jupiterB1C, jupiterB1D)
	term(jupiterB2A, jupiterB2B, jupiterB2C, jupiterB2D)
	term(jupiterB3A, jupiterB3B, jupiterB3C, jupiterB3D)
	term(jupiterB4A, jupiterB4B, jupiterB4C, jupiterB4D)
	term(jupiterB5A, jupiterB5B, jupiterB5C, jupiterB5D)


    
    #sum the series, store in coefficient variables in the form, planet(L/B/R)(Number of Coefficient)

	jupiterB0 = fsum(jupiterB0D)
	jupiterB1 = fsum(jupiterB1D)

	jupiterB2 = fsum(jupiterB2D)

	jupiterB3 = fsum(jupiterB3D)
	jupiterB4 = fsum(jupiterB4D)
	jupiterB5 = fsum(jupiterB5D)

    
    

	#store terms in D lists for RADIUS VECTOR:

	term(jupiterR0A, jupiterR0B, jupiterR0C, jupiterR0D)
	term(jupiterR1A, jupiterR1B, jupiterR1C, jupiterR1D)

	term(jupiterR2A, jupiterR2B, jupiterR2C, jupiterR2D)
	term(jupiterR3A, jupiterR3B, jupiterR3C, jupiterR3D)
	term(jupiterR4A, jupiterR4B, jupiterR4C, jupiterR4D)
	term(jupiterR5A, jupiterR5B, jupiterR5C, jupiterR5D)


    
    #sum the series, store in coefficient variables in the form, planet(L/B/R)(Number of Coefficient)

	jupiterR0 = fsum(jupiterR0D)
	jupiterR1 = fsum(jupiterR1D)
	jupiterR2 = fsum(jupiterR2D)
	jupiterR3 = fsum(jupiterR3D)
	jupiterR4 = fsum(jupiterR4D)
	jupiterR5 = fsum(jupiterR5D)


    
    
# JUPITER's heliocentric longitude:

	hlJ = (jupiterL0 + jupiterL1*(tau1) + jupiterL2*(tau1**2) + jupiterL3*(tau1**3) + jupiterL4*(tau1**4) + jupiterL5*(tau1**5))/(100000000) % (2*pi)


    
    #JUPITER's heliocentric latitude:


	hbJ = (jupiterB0 + jupiterB1*(tau1) + jupiterB2*(tau1**2) + jupiterB3*(tau1**3) + jupiterB4*(tau1**4) + jupiterB5*(tau1**5))/(100000000) % (2*pi)


    
    #JUPITER's radius vector:

	hrJ = (jupiterR0 + jupiterR1*(tau1) + jupiterR2*(tau1**2) + jupiterR3*(tau1**3) + jupiterR4*(tau1**4) + jupiterR5*(tau1**5))/(100000000)


    
    
#x, y, and z coordinates of Jupiter

	xj = hrJ*(cos(hbJ))*(cos(hlJ)) - hr0*(cos(hl0))
	yj = hrJ*(cos(hbJ))*(sin(hlJ)) - hr0*(sin(hl0))
	zj = hrJ*(sin(hbJ)) - hr0*(sin(hb0))


    
    #displacement of Jupiter (delta1)

	delta1 = sqrt((xj**2) + (yj**2) + (zj**2))

    
    
	#corrected heliocentric longitude of jupiter to light-time

	hlJC = degrees(hlJ) + ((-0.012990)*delta1/(hrJ**2))


    
    #corrected x, y, and z coordinates of Jupiter using adjustment to light-time

	xjc = hrJ*(cos(hbJ))*(cos(radians(hlJC))) - hr0*(cos(hl0))
	yjc = hrJ*(cos(hbJ))*(sin(radians(hlJC))) - hr0*(sin(hl0))
	zjc = hrJ*(sin(hbJ)) - hr0*(sin(hb0))

    
    	
	#corrected displacement (delta2)
	delta2 = sqrt((xjc**2) + (yjc**2) + (zjc**2))
	tau2 = 10*tau1


    
    #mean obliquity in degrees

	meanObl = 23.43929111 - (0.013004167*tau2) - (0.0000001638888*(tau2**2)) + (0.00000050361112*(tau2**3))


    
    #variables u and v used for calculating rAsc1 and rDec1

	uvar = yjc*(cos(radians(meanObl))) - zjc*(sin(radians(meanObl)))
	vvar = yjc*(sin(radians(meanObl))) + zjc*(cos(radians(meanObl)))


    
    #right ascension and declination with correction

    
    #rAsc1 is between 0 and 360 degrees

	angleAsc = degrees(atan(uvar/xjc))
	if uvar >= 0 and xjc >= 0:
		rAsc1 = angleAsC
	elif uvar >= 0 and xjc < 0:
		rAsc1 = angleAsc + 180
	elif uvar < 0 and xjc < 0:
		rAsc1 = angleAsc + 180

	elif uvar < 0 and xjc >= 0:
		rAsc1 = angleAsc + 360
	else:
		rAsc1 = 0


    
    #rDec1 is between -90 and 90 degrees
	rDec1 = degrees(atan(vvar/(sqrt((xjc**2) + (uvar**2)))))

    
    	
	#zeta, the angle based on position of earth and jupiter

	znum = ((sin(radians(rDec0)))*(cos(radians(rDec1)))*(cos(radians(rAsc0) - radians(rAsc1))) - (sin(radians(rDec1)))*(cos(radians(rDec0))))
	zden = ((cos(radians(rDec1)))*(sin(radians(rAsc0) - radians(rAsc1))))

	zAngle = degrees(atan(znum/zden))
	zeta = zAngle


	if znum >= 0 and zden >= 0:
		zeta = zAngle
	elif znum >= 0 and zden < 0:
		zeta = zAngle + 180
	elif znum < 0 and zden < 0:
		zeta = zAngle + 180
	elif znum < 0 and zden >= 0:
		zeta = zAngle + 360
	else:
		zeta = 0


	cm = (Wsub2 - zeta - 5.02626*delta2) % 360


    
    #Great Red Spot longitude linear approximations from JUPOS data

	if JDE < 2400410.500000:
		grsLong = 175
	elif 2400410.500000 <= JDE < 2406620.500000:
		grsLong = (-0.01545893719*JDE + 37355.7951497) % 360
	elif 2406620.500000 <= JDE < 2412098.500000:
		grsLong = (0.00002188182*((JDE - 2407715.500000)**2) +68) % 360
	elif 2433282.500000 <= JDE < 2441499.500000:
		grsLong = (-0.00001130943*((JDE - 2439642.500000)**2) + 39) % 360
	elif 2441499.500000 <= JDE < 2444239.500000:
		grsLong = (-0.00000825829*((JDE - 2444239.500000)**2) + 60) % 360
	elif 2444239.500000 <= JDE < 2446796.500000:
		grsLong = (-1.74991496185*((JDE -2445516.500000)**(1/3)) + 40) % 360
	elif 2446796.500000 <= JDE < 2454832.500000:
		grsLong = (0.01343952215*JDE - 32871.7757591) % 360
	elif JDE > 2454832.500000:
		grsLong = (0.05080858445*JDE - 124611.53898) % 360
	else:
		grsLong = 0

	grsPos = cm - grsLong

	return grsPos


